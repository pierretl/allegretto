{% import 'macro.twig' as macro %}



{% set sejourAVenir = false %}

{% for item in sejours %}
    {% for famille in item.validation %}
        {% if famille.id == session.utilisateur.famille and famille.accord != '' %}
            {% if item.departReel|date("U") > "now"|date("U") %}
                {% set sejourAVenir = true %}
            {% endif %}
        {% endif %}
    {% endfor %}
{% endfor %}


{% if sejourAVenir %}
    <div class="cadre-m bg-neutral-000 df fd-c gap-cadre-m">
        <div class="hide-for-medium">
            <a href="#addSejour" class="btn-2">Ajouter un séjour</a>
        </div>

        <h2 class="titre">Les séjours à venir</h2>

        <ul class="df gap-cadre-s">
            <li>
                <button class="btn-2 js_filtrePerso v_off" type="button" title="Afficher les séjours de ma famille" aria-pressed="false">
                    Mes séjours
                </button>
            </li>
            <li>
                <button class="btn-2 js_filtreAutres v_off" type="button" title="Afficher les autres séjours" aria-pressed="false">
                    Les autres
                </button>
            </li>
            <li>
                <button class="btn-2 js_filtreTous" type="button" title="Tous affiché" aria-pressed="true">
                    Tous
                </button>
            </li>
        </ul>

        <ul class="df fd-c gap-cadre-s js_listeAFiltre" data-famille="{{ session.utilisateur.famille }}" aria-live="polite">
            
            {% for item in sejours %}
                    {% set sejourKey = loop.index %}

                    {% for famille in item.validation %}
                        {% if famille.id == session.utilisateur.famille and famille.accord != '' %}
                            {% if item.departReel|date("U") > "now"|date("U") %}

                                {% if session.utilisateur.famille == item.pourFamille %}
                                    {% set btnSupprimer = true %}
                                {% else %}
                                    {% set btnSupprimer = false %}
                                {% endif %}

                                {{ macro.cadreSejour({
                                    sejourKey:              sejourKey,
                                    titre:                  item.title,
                                    dateStart:              item.start,
                                    departReel:             item.departReel,
                                    commentaire:            item.commentaire,
                                    parUtilisateur:         item.parUtilisateur,
                                    pourFamille:            item.pourFamille,
                                    btnSupprimer:           btnSupprimer,
                                }) }}

                            {% endif %}
                        {% endif %}
                    {% endfor %}

            {% endfor %}
        </ul>

        {{ include('include/script-suppressionSejour.twig') }}
        {{ include('include/script-filtreListe.twig') }}

    </div>
{% endif %}